<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador da Mônada</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom": "https://esm.sh/react-dom@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "recharts": "https://esm.sh/recharts@2.12.7?external=react,react-dom",
        "lucide-react": "https://esm.sh/lucide-react@0.378.0"
      }
    }
    </script>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useMemo, createElement as e } from 'react';
        import { createRoot } from 'react-dom/client';
        import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ReferenceLine } from 'recharts';

        const App = () => {
            const [stockPrice, setStockPrice] = useState(22.00);
            const [weeksRolled, setWeeksRolled] = useState(0);
            
            const longPutStrike = 22.00;
            const shortCallStrike = 21.50;
            const longCallStrike = 23.00;
            const initialCost = 3.00;
            const rollCredit = 0.20;

            const chartData = useMemo(() => {
                const data = [];
                const accumulatedCredit = rollCredit * weeksRolled;
                const totalCost = initialCost - accumulatedCredit;

                for (let price = 15; price <= 30; price += 0.5) {
                    const longPutValue = Math.max(longPutStrike - price, 0);
                    const longCallValue = Math.max(price - longCallStrike, 0);
                    const shortCallValue = 2 * Math.max(price - shortCallStrike, 0);
                    const pnl = (longPutValue + longCallValue - shortCallValue) - totalCost;
                    data.push({ price, pnl: parseFloat(pnl.toFixed(2)) });
                }
                return data;
            }, [weeksRolled]);

            const currentPnL = useMemo(() => {
                const totalCost = initialCost - (rollCredit * weeksRolled);
                const lp = Math.max(longPutStrike - stockPrice, 0);
                const lc = Math.max(stockPrice - longCallStrike, 0);
                const sc = 2 * Math.max(stockPrice - shortCallStrike, 0);
                return (lp + lc - sc - totalCost).toFixed(2);
            }, [stockPrice, weeksRolled]);

            // Interface construída sem usar as tags < > que causam erro
            return e('div', { className: 'min-h-screen p-8 font-sans' }, 
                e('div', { className: 'max-w-4xl mx-auto' },
                    e('header', { className: 'mb-8 text-center' },
                        e('h1', { className: 'text-3xl font-bold text-slate-900' }, 'Simulador da Mônada'),
                        e('p', { className: 'text-slate-500' }, 'Alimentador Over Strip')
                    ),
                    e('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-6' },
                        e('div', { className: 'bg-white p-6 rounded-xl shadow border border-slate-200' },
                            e('label', { className: 'block text-xs font-bold mb-2' }, `PREÇO DA AÇÃO: R$ ${stockPrice}`),
                            e('input', { type: 'range', min: 15, max: 30, step: 0.1, value: stockPrice, onChange: x => setStockPrice(Number(x.target.value)), className: 'w-full mb-6' }),
                            e('label', { className: 'block text-xs font-bold mb-2' }, `ROLAGENS: ${weeksRolled}`),
                            e('input', { type: 'range', min: 0, max: 52, value: weeksRolled, onChange: x => setWeeksRolled(Number(x.target.value)), className: 'w-full' }),
                            e('div', { className: 'mt-6 p-4 bg-slate-900 rounded-lg text-white' },
                                e('p', { className: 'text-[10px] text-slate-400' }, 'PnL ESTIMADO'),
                                e('p', { className: 'text-2xl font-bold' }, `R$ ${currentPnL}`)
                            )
                        ),
                        e('div', { className: 'md:col-span-2 bg-white p-4 rounded-xl shadow border border-slate-200 h-96' },
                            e(ResponsiveContainer, { width: '100%', height: '100%' },
                                e(LineChart, { data: chartData },
                                    e(CartesianGrid, { strokeDasharray: '3 3' }),
                                    e(XAxis, { dataKey: 'price' }),
                                    e(YAxis),
                                    e(Tooltip),
                                    e(ReferenceLine, { y: 0, stroke: '#000', strokeWidth: 2 }),
                                    e(ReferenceLine, { x: stockPrice, stroke: 'red', strokeDasharray: '3 3' }),
                                    e(Line, { type: 'monotone', dataKey: 'pnl', stroke: '#4f46e5', strokeWidth: 4, dot: false })
                                )
                            )
                        )
                    )
                )
            );
        };

        createRoot(document.getElementById('root')).render(e(App));
    </script>
</body>
</html>
